"use strict";(self.webpackChunkfisthero_ui=self.webpackChunkfisthero_ui||[]).push([[260],{6260:function(e,t,n){n.r(t),n.d(t,{FullContainer:function(){return q},StartModal:function(){return S}});var s,a=n(7186),r=n(3430),i=n(7313),c=n(7890),m=n(9466),l=n(1843),o=n(8197),d=n(9624),g=n(3912),u=n(1114),x=n(9184),f=n(8805),b=n(5035),h=n(1361),p=n(1733),v=n.n(p),j=n(6749),w=n(56),N=n(1158),k=n(508),F=n(9560),I=n(8955),_=n(3557),y=n(3122),D=n(658),Z=n.n(D),T=n(6417);t.default=function(){var e,t=(0,h.u)(),n=t.data,s=(t.isLoading,(0,N.o)()),a=s.data,g=(s.isLoading,(0,i.useState)(!1)),x=(0,r.Z)(g,2),p=x[0],_=x[1],y=(0,i.useState)(!1),D=(0,r.Z)(y,2),Z=D[0],A=D[1],C=(0,i.useState)(!1),M=(0,r.Z)(C,2),P=M[0],E=M[1],L=(0,c.bS)("/gaming/:subPath"),R=null===L||void 0===L||null===(e=L.params.subPath)||void 0===e?void 0:e.split("-"),O=(0,r.Z)(R,2),$=O[0],z=O[1];console.log("scene",$,"squadId",z);var U=[],B=!1,K=0,V=!1;a&&a.squadIdToFightInfo&&a.squadIdToFightInfo[z]&&(B=a.squadIdToFightInfo[z].isFighting,U=a.squadIdToFightInfo[z].heroIds,K=a.squadIdToFightInfo[z].fightEndTime,V=a.squadIdToFightInfo[z].pendingReward.gt(F.O$.from(0)),(0,I.f)("game.squadIdToFightInfo[squadId]",a.squadIdToFightInfo[z]));var H=(0,w.useMutation)((function(){return(0,u.Kc)(a),a.claimFightReward()}),{onSuccess:function(){l.Z.success({message:"claim success"})},onError:function(e){var t;return l.Z.error({message:"claim failed",description:null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message})}}),G=H.mutateAsync,W=(H.isLoading,function(e){return n&&e in n.config.NFTInfoMap?n.config.NFTInfoMap[e].name.toLowerCase():"-"}),J=function(e){return n&&e in n.config.NFTInfoMap?n.config.NFTInfoMap[e].rarity:"-"};return(0,T.jsxs)(q,{className:"gaming",children:[(null===L||void 0===L?void 0:L.params.subPath)&&(0,T.jsx)("img",{className:"bg-full",src:(0,u.vg)("gaming/boss_scene_desktop/boss_scene".concat($,"_desktop.png")),alt:"gaming"}),(0,T.jsxs)("div",{className:"header mask  text-2xl text-[#FFDDA8]]",children:[(0,T.jsx)(m.rU,{to:"/gaming",children:(0,T.jsx)("div",{className:"absolute  mt-[0.2rem] left-[0.7rem] w-[4rem]  flex flex-row justify-center  items-center",children:(0,T.jsx)("div",{className:"clickable w-[9rem] h-[5rem] mr-2 bg-[url(/public/assets/gaming/button-back.png)] bg-contain bg-center bg-no-repeat"})})}),(0,T.jsx)(f.pB,{type:"primary",className:"hidden md:block clickable absolute left-[5.5rem] w-[10rem] h-[4rem] leading-[1.8rem] mt-3 text-xl bg-[url(/public/assets/gaming/connect-bg-border.png)] bg-contain bg-center bg-no-repeat"}),(0,T.jsxs)("div",{className:"absolute right-[2rem] md:right-[15rem] w-[20rem] mt-[0.2rem]  flex flex-row justify-center items-center",children:[(0,T.jsx)("div",{className:"pl-[2rem] text-xl text-[#FFDDA8] text-center leading-[5rem] clickable w-[10rem] h-[5rem] mr-4 bg-[url(/public/assets/gaming/coin.png)] bg-contain bg-center bg-no-repeat",onClick:function(){return G()},children:a?v()((0,j.formatEther)(a.config._pendingReward)).format("0,0"):0}),(0,T.jsxs)("div",{className:"text-sm text-[#FFDDA8] text-center leading-[5rem] clickable w-[7rem] h-[5rem] mr-4 bg-[url(/public/assets/gaming/fee.png)] bg-contain bg-center bg-no-repeat",children:["Fee: ",a?v()((0,j.formatUnits)(a.config._rewardFee,2)).format("0,0%"):"0%"]}),(0,T.jsx)("div",{className:"clickable w-[3rem] h-[4rem] mt bg-[url(/public/assets/gaming/setting.png)] bg-contain bg-center bg-no-repeat",onClick:function(){return _((function(e){return!e}))}})]})]}),(0,T.jsxs)("div",{className:"main relative content content--contains-header",children:[(0,T.jsx)("div",{className:"absolute md:top-[10rem] top-[30%]",children:B&&(0,T.jsx)(f.IT,{targetDatetime:K})}),(0,T.jsxs)(o.Z,{gutter:40,className:"absolute bottom-[2rem]",children:[(0,T.jsx)(d.Z,{xs:24,sm:16,md:16,lg:16,className:"flex flex-row justify-center items-center md:w-[50rem] w-[15rem]",children:(0,T.jsx)(o.Z,{gutter:1,className:"md:w-full w-8/12 flex flex-row justify-center items-center",children:U.map((function(e){return(0,T.jsx)(d.Z,{xs:8,sm:8,md:8,lg:8,className:"flex justify-center items-center",children:(0,T.jsx)(k.Z,{className:"md:w-[34rem] w-[18rem]",autoPlay:B,src:(0,u.vg)("gaming/attack_apng_desktop/attack_".concat(W(e)+J(e),"_desktop.png")),alt:"gaming/attack_apng_desktop/attack_".concat(W(e)+J(e),"_desktop.png")})},"attack-"+e)}))})}),(0,T.jsxs)(d.Z,{xs:24,sm:16,md:8,lg:8,className:"mt-[-1rem] md:mt-[-0.1rem]",children:[(B||!V)&&(0,T.jsx)(k.Z,{className:"w-[42rem]",autoPlay:!0,src:(0,u.vg)("gaming/boss_apng_desktop/boss".concat($,"_idle_desktop.png")),alt:"gaming/boss_apng_desktop/boss1_idle_desktop.png"}),!B&&V&&(0,T.jsx)(k.Z,{className:"w-[42rem]",autoPlay:!0,isOneTime:!0,src:(0,u.vg)("gaming/boss_apng_desktop/boss".concat($,"_dead_desktop.png")),alt:"gaming/boss_apng_desktop/boss1_idle_desktop.png"})]})]})]}),(0,T.jsxs)(b.V,{open:p,onClose:function(){return _(!1)},className:"gaming relative z-50",children:[(0,T.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,T.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,T.jsxs)(b.V.Panel,{className:"flex flex-column justify-center items-center mx-auto max-w-lg rounded w-[20rem] h-[29rem] bg-[url(/public/assets/gaming/bg-dialog.png)] bg-contain bg-center bg-no-repeat",children:[(0,T.jsx)(b.V.Title,{className:"text-3xl text-[#28170B] font-extrabold\tstroke-current",children:"Sound Setting"}),(0,T.jsxs)("div",{className:"w-7/12 mt-6",children:[(0,T.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,T.jsx)("div",{className:"text-2xl text-black",children:"BGM"}),(0,T.jsx)("div",{className:"clickable w-[1.6rem] h-[1.6rem] bg-contain bg-center bg-no-repeat ".concat(P?"bg-[url(/public/assets/gaming/vol-muted.png)]":"bg-[url(/public/assets/gaming/vol.png)]"),onClick:function(){E((function(e){return!e}))}})]}),(0,T.jsxs)("div",{className:"mt-2 flex flex-row justify-between items-center",children:[(0,T.jsx)("div",{className:"text-2xl text-black",children:"SoundEffect"}),(0,T.jsx)("div",{className:"clickable w-[1.6rem] h-[1.6rem] bg-contain bg-center bg-no-repeat ".concat(Z?"bg-[url(/public/assets/gaming/vol-muted.png)]":"bg-[url(/public/assets/gaming/vol.png)]"),onClick:function(){A((function(e){return!e}))}})]})]})]})})]}),!B&&a&&a.squadIdToFightInfo[z]&&(0,T.jsx)(S,{squadId:z,gameId:$,fightInfo:a.squadIdToFightInfo[z]})]})};var q=x.ZP.div(s||(s=(0,a.Z)(["\n  position: absolute;\n  top: 0;\n  right: 0;\n  left: 0;\n  bottom: 0;\n\n  .bg-full {\n    width: 100%;\n    height: 100%;\n    position: fixed;\n    object-fit: cover;\n    z-index: 0;\n  }\n\n  .mask {\n    position: fixed;\n    top: 0;\n    right: 0;\n    left: 0;\n\n    z-index: 11;\n    background: rgba(0, 0, 0, 0.25);\n  }\n\n  .content {\n    position: relative;\n    height: 100vh;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n\n    &--contains-header {\n      margin-top: 80px;\n      height: calc(100vh - 80px);\n    }\n  }\n\n  @media (max-width: 768px) {\n    .content {\n      &--contains-header {\n        margin-top: 60px;\n        height: calc(100vh - 60px);\n      }\n    }\n  }\n\n  & + * {\n    position: relative;\n    top: 100vh;\n  }\n"]))),S=function(e){var t=e.squadId,n=e.gameId,s=e.fightInfo,a=(0,N.o)(),r=a.data,i=(a.isLoading,(0,w.useMutation)((function(){return(0,I.f)("start fight, fightInfo",s),(0,u.Kc)(r),r.fight(F.O$.from(t),F.O$.from(n))}),{onSuccess:function(){l.Z.success({message:"Start Fight"})},onError:function(e){var t;return l.Z.error({message:"Send fight tx failed",description:null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message})}})),c=i.mutateAsync,o=i.isLoading,d=(0,w.useMutation)((function(){return(0,I.f)("start claim, fightInfo",s),(0,u.Kc)(r),s.fightPendingReward.eq(F.O$.from(0))&&l.Z.error({message:"No Fight Reward"}),r.transferSquadToPendingReward(F.O$.from(t))}),{onSuccess:function(){l.Z.success({message:"claim succeed"})},onError:function(e){var t;return l.Z.error({message:"claim failed",description:null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message})}}),x=d.mutateAsync,f=d.isLoading;return(0,T.jsx)(g.Z,{visible:!0,maskStyle:{background:"rgba(0,0,0,.3)"},className:"gaming relative z-50 flex flex-col justify-center items-center",width:window.innerWidth>768?"80rem":"30rem",footer:null,closable:!1,children:(0,T.jsxs)("div",{className:"relative w-[25rem] h-[23.5rem] md:w-[45rem] md:h-[36rem] flex flex-col justify-center items-center bg-[url(/public/assets/gaming/start-modal-bg.png)] bg-contain bg-center bg-no-repeat",children:[(0,T.jsx)(m.rU,{to:"/gaming",children:(0,T.jsx)("div",{className:"absolute top-[5rem] mt-[0.2rem] md:left-[2rem] left-[1rem] md:w-[4rem] w-[3rem]  flex flex-row justify-center items-center",children:(0,T.jsx)("div",{className:"clickable w-[9rem] h-[5rem] mr-2 bg-[url(/public/assets/gaming/button-back.png)] bg-contain bg-center bg-no-repeat"})})}),(0,T.jsxs)("div",{className:"px-3 mb-2 md:w-[24rem] w-[17rem] md:h-[3rem] md:mt-[0rem] mt-[2rem] h-[1.7rem] flex justify-between items-center bg-[#FFDDA8] text-[#68452D] rounded-lg border-current border-2",children:[(0,T.jsx)("div",{className:"md:text-2xl text-md text-[#68452D]",children:(0,T.jsx)(_.xv,{tid:"pending-reward"})}),(0,T.jsx)("div",{className:"text-[#00A660]",children:v()((0,j.formatEther)(s.fightPendingReward)).format("0,0")})]}),(0,T.jsxs)("div",{className:"px-3 mb-2 md:w-[24rem] w-[17rem] md:h-[3rem]  h-[1.7rem] flex justify-between items-center bg-[#FFDDA8] text-[#68452D] rounded-lg border-current border-2",children:[(0,T.jsx)("div",{className:"md:text-2xl text-md text-[#68452D]",children:(0,T.jsx)(_.xv,{tid:"attack"})}),(0,T.jsx)("div",{className:"text-[#00A660]",children:v()((0,j.formatEther)(s.attack)).format("0,0")})]}),(0,T.jsxs)("div",{className:"px-3 mb-2 md:w-[24rem] w-[17rem] md:h-[3rem]  h-[1.7rem] flex justify-between items-center bg-[#FFDDA8] text-[#68452D] rounded-lg border-current border-2",children:[(0,T.jsx)("div",{className:"md:text-2xl text-md text-[#68452D]",children:(0,T.jsx)(_.xv,{tid:"last-fight-end-at"})}),(0,T.jsx)("div",{className:"text-[#00A660]",children:Z()(s.fightEndTime).utc().format("DD MMM, HH:mm:ss")+" UTC"})]}),(0,T.jsxs)("div",{className:"flex flex-row justify-center items-center mb-2",children:[(0,T.jsxs)("div",{className:"text-center md:text-xl text-md text-[#FFDDA8] md:leading-[5rem] leading-[4rem]  font-extrabold md:w-[12rem] md:h-[4.7rem] w-[10rem] h-[3.6rem]  bg-[url(/public/assets/mining/button-claim-1.png)] bg-contain bg-center bg-no-repeat cursor-pointer",onClick:function(){return c()},children:[o&&(0,T.jsx)(y.fCD,{className:"animate-spin inline-block mx-auto"}),!o&&(0,T.jsx)(_.xv,{tid:"start-fight"})]}),(0,T.jsxs)("div",{className:"text-center md:text-xl text-md text-[#FFDDA8] md:leading-[5rem] leading-[4rem]  font-extrabold md:w-[12rem] md:h-[4.7rem] w-[10rem] h-[3.6rem]  bg-[url(/public/assets/mining/button-claim-2.png)] bg-contain bg-center bg-no-repeat cursor-pointer",onClick:function(){return x()},children:[f&&(0,T.jsx)(y.fCD,{className:"animate-spin inline-block mx-auto"}),!f&&(0,T.jsx)(_.xv,{tid:"claim-fight-reward"})]})]})]})})}}}]);