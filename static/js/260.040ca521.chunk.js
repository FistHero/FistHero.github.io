"use strict";(self.webpackChunkfisthero_ui=self.webpackChunkfisthero_ui||[]).push([[260],{1361:function(e,n,r){r.d(n,{u:function(){return g}});var t=r(3032),a=r(4322),s=r.n(a),i=r(334),c=r(7998),u=r(56),o=r(1114),l=r(658),p=r.n(l),d=r(8955),m=r(1843);function g(){var e=(0,i.I1)(),n=(0,c.K)().account,r=(0,u.useQueryClient)();return(0,u.useQuery)(["queryHero",{account:n}],(0,t.Z)(s().mark((function a(){var i,c,u,l,g,f,v,x,b,h,w,k,y,N,j,Z;return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return(0,o.Kc)(e),(0,o.Kc)(n),a.next=4,e.getConfig(n);case 4:return i=a.sent,(0,d.f)("hero config",i),c=i.NFTIds,u=i.purchaseTokenApproved,l=i.sellingStartTime,g=i.isInWhitelist,f=i.nativeBalance,v=i.buyBoxTokenBalance,x=i.heroMainTokenBalance,b=i.boxes,h=i.airdropBoxes,w=u,k=p()(),y=l>0&&k.isAfter(l),N=c,a.next=13,e.checkFHTApproved();case 13:return j=a.sent,a.next=16,e.getInviteesInfo(n);case 16:return Z=a.sent,a.abrupt("return",{config:i,isApproved:w,isWithinSellingPeriod:y,isInWhitelist:g,nftIds:N,nativeBalance:f,buyBoxTokenBalance:v,heroMainTokenBalance:x,boxes:b,airdropBoxes:h,DHTApproved:j,inviteesInfo:Z,approve:function(){var n=(0,t.Z)(s().mark((function n(){var t;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t="",w){n.next=8;break}return n.next=4,e.approveToken();case 4:return t=n.sent,n.next=7,r.invalidateQueries("queryHero");case 7:m.Z.success({message:"Approve BUSD Succeed"});case 8:return n.abrupt("return",t);case 9:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),approveDHT:function(){var n=(0,t.Z)(s().mark((function n(){var t;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.approveDHT();case 2:return t=n.sent,n.next=5,r.invalidateQueries("queryHero");case 5:return n.abrupt("return",t);case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),buyBoxesWithInviter:function(){var n=(0,t.Z)(s().mark((function n(t,a){var i;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.buyBoxesWithInviter(t,a);case 2:return i=n.sent,n.next=5,r.invalidateQueries("queryHero");case 5:return n.abrupt("return",i);case 6:case"end":return n.stop()}}),n)})));return function(e,r){return n.apply(this,arguments)}}(),buyAndOpenBoxesWithInviter:function(){var n=(0,t.Z)(s().mark((function n(t,a){var i;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(w){n.next=6;break}return n.next=3,e.approveToken();case 3:return n.next=5,r.invalidateQueries("queryHero");case 5:m.Z.success({message:"approve success"});case 6:if(y){n.next=11;break}return m.Z.error({message:"sell not start"}),n.abrupt("return",[]);case 11:return n.next=13,e.buyAndOpenBoxesWithInviter(t,a);case 13:return i=n.sent,n.next=16,r.invalidateQueries("queryHero");case 16:return n.abrupt("return",i);case 17:case"end":return n.stop()}}),n)})));return function(e,r){return n.apply(this,arguments)}}(),openBoxes:function(){var n=(0,t.Z)(s().mark((function n(t){var a;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.openBoxes(t);case 2:return a=n.sent,n.next=5,r.invalidateQueries("queryHero");case 5:return n.abrupt("return",a);case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),mergeNFT:function(){var n=(0,t.Z)(s().mark((function n(t){var a;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((0,d.f)(j),j){n.next=8;break}return m.Z.success({message:"start approve DHT"}),n.next=5,e.approveDHT();case 5:return n.next=7,r.invalidateQueries("queryHero");case 7:m.Z.success({message:"approve DHT succeed"});case 8:return n.next=10,e.mergeNFT(t);case 10:return a=n.sent,n.next=13,r.invalidateQueries("queryHero");case 13:return n.abrupt("return",a);case 14:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),generateAttack:function(){var n=(0,t.Z)(s().mark((function n(){var t;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(0,d.f)("nftIds",N),n.next=3,e.generateAttack(N);case 3:return t=n.sent,n.next=6,r.invalidateQueries("queryHero");case 6:return n.abrupt("return",t);case 7:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()});case 18:case"end":return a.stop()}}),a)}))),{enabled:!!n&&!!e})}},4775:function(e,n,r){r.d(n,{o:function(){return p}});var t=r(3032),a=r(4322),s=r.n(a),i=r(334),c=r(7998),u=r(56),o=r(1114),l=r(8955);function p(){var e="queryHeroGame",n=(0,i.T6)(),r=(0,c.K)().account,a=(0,u.useQueryClient)();return(0,u.useQuery)([e,{account:r}],(0,t.Z)(s().mark((function i(){var c;return s().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return(0,o.Kc)(n),(0,o.Kc)(r),i.next=4,n.getGameInfo(r);case 4:return c=i.sent,(0,l.f)("hero game config",c),i.abrupt("return",{config:c,createSquad:function(){var r=(0,t.Z)(s().mark((function r(t,i){var c;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.createSquad(t,i);case 2:return c=r.sent,r.next=5,a.invalidateQueries(e);case 5:return r.abrupt("return",c);case 6:case"end":return r.stop()}}),r)})));return function(e,n){return r.apply(this,arguments)}}(),fight:function(){var r=(0,t.Z)(s().mark((function r(t){var i;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.fight(t);case 2:return i=r.sent,r.next=5,a.invalidateQueries(e);case 5:return r.abrupt("return",i);case 6:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),claimFightReward:function(){var r=(0,t.Z)(s().mark((function r(t){var i;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.claimFightReward(t);case 2:return i=r.sent,r.next=5,a.invalidateQueries(e);case 5:return r.abrupt("return",i);case 6:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()});case 7:case"end":return i.stop()}}),i)}))),{enabled:!!r&&!!n})}},4967:function(e,n,r){r.d(n,{p:function(){return m}});var t=r(3032),a=r(4322),s=r.n(a),i=r(7998),c=r(56),u=r(1114),o=r(334),l=r(8955),p=r(9560),d=r(2388);function m(){var e=(0,o.FJ)(),n=(0,i.K)().account,r=(0,c.useQueryClient)();return(0,c.useQuery)(["queryNFTPool",{account:n}],(0,t.Z)(s().mark((function a(){var i,c,o,m,g,f,v,x;return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return(0,u.Kc)(e),(0,u.Kc)(n),(0,l.f)("before getFarmInfo"),a.next=5,e.getFarmInfo(n);case 5:return i=a.sent,(0,l.f)("getFarmInfo",i),a.next=9,e.getStakedNFTIds(n);case 9:return c=a.sent,(0,l.f)("stakedNFTs",c),o=1e8,m=i.userHashPower.mul(o).div(i.totalHashPower),g=i.rewardPerSecond.mul(3).div(1e3),f=p.O$.from(86400),v=g.mul(f).mul(m).div(o),x={historyReward:i.claimed.mul(3).div(1e3),oneDayReward:v,monthReward:v.mul(30),yearReward:v.mul(365)},(0,l.f)("rewardsMap",(0,d.formatEther)(x.historyReward),(0,d.formatEther)(x.oneDayReward)),a.abrupt("return",{farmInfo:i,stakedNFTs:c,rewardsMap:x,harvest:function(){var n=(0,t.Z)(s().mark((function n(){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",e.harvest().then((function(e){return r.invalidateQueries("queryNFTPool"),e})));case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),harvestUSDT:function(){var n=(0,t.Z)(s().mark((function n(){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",e.harvestUSDT().then((function(e){return r.invalidateQueries("queryNFTPool"),e})));case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),stakeNFT:function(){var n=(0,t.Z)(s().mark((function n(t){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",e.stakeNFT(t).then((function(e){return r.invalidateQueries("queryNFTPool"),e})));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),withdrawNFT:function(){var n=(0,t.Z)(s().mark((function n(t){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",e.withdrawNFT(t).then((function(e){return r.invalidateQueries("queryNFTPool"),e})));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()});case 19:case"end":return a.stop()}}),a)}))),{enabled:!!e&&!!n})}},6260:function(e,n,r){r.r(n),r.d(n,{FightModal:function(){return j},FullContainer:function(){return N}});var t,a=r(7186),s=r(3430),i=r(7313),c=r(7890),u=r(9466),o=r(8197),l=r(9624),p=r(1843),d=r(3912),m=r(9491),g=r(1114),f=r(9184),v=r(8805),x=r(5035),b=r(1361),h=(r(1733),r(2388),r(4967)),w=r(56),k=r(4775),y=r(6417);n.default=function(){var e=(0,b.u)(),n=e.data,r=(e.isLoading,(0,k.o)()),t=(r.data,r.isLoading,(0,i.useState)(!1)),a=(0,s.Z)(t,2),p=a[0],d=a[1],m=(0,i.useState)(!1),f=(0,s.Z)(m,2),h=f[0],w=f[1],Z=(0,i.useState)(!1),T=(0,s.Z)(Z,2),F=T[0],S=T[1],I=(0,i.useState)(!1),H=(0,s.Z)(I,2),Q=H[0],_=H[1],B=(0,c.bS)("/gaming/goblin/:subPath");console.log("match",null===B||void 0===B?void 0:B.params.subPath);var q=function(e){return n&&e in n.config.NFTInfoMap?n.config.NFTInfoMap[e].name.toLowerCase():"-"},A=function(e){return n&&e in n.config.NFTInfoMap?n.config.NFTInfoMap[e].rarity:"-"};return(0,y.jsxs)(N,{className:"gaming",children:[(null===B||void 0===B?void 0:B.params.subPath)&&(0,y.jsx)("img",{className:"bg-full",src:(0,g.vg)("gaming/boss_scene_desktop/boss_scene".concat(B.params.subPath,"_desktop.png")),alt:"gaming"}),(0,y.jsxs)("div",{className:"header mask  text-2xl text-[#FFDDA8]]",children:[(0,y.jsx)(u.rU,{to:"/gaming",children:(0,y.jsx)("div",{className:"absolute  mt-[0.2rem] left-[0.7rem] w-[4rem]  flex flex-row justify-center  items-center",children:(0,y.jsx)("div",{className:"clickable w-[9rem] h-[5rem] mr-2 bg-[url(/public/assets/gaming/button-back.png)] bg-contain bg-center bg-no-repeat"})})}),(0,y.jsx)(v.pB,{type:"primary",className:"hidden md:block clickable absolute left-[5.5rem] w-[10rem] h-[4rem] leading-[1.8rem] mt-3 text-xl bg-[url(/public/assets/gaming/connect-bg-border.png)] bg-contain bg-center bg-no-repeat"}),(0,y.jsxs)("div",{className:"hidden lg:flex absolute mt-[0.2rem] left-[18rem] w-[33rem] flex-row justify-center items-center display-none",children:[(0,y.jsx)("div",{className:"clickable w-[10rem] h-[5rem] mr-4 bg-[url(/public/assets/gaming/my-hero.png)] bg-contain bg-center bg-no-repeat"}),(0,y.jsx)("div",{className:"clickable w-[10rem] h-[5rem] mr-4 bg-[url(/public/assets/gaming/my-squad.png)] bg-contain bg-center bg-no-repeat"}),(0,y.jsx)("div",{className:"clickable w-[10rem] h-[5rem] bg-[url(/public/assets/gaming/my-backpack.png)] bg-contain bg-center bg-no-repeat"})]}),(0,y.jsxs)("div",{className:"absolute right-[0.1rem] lg:right-[15rem] w-[20rem] mt-[0.2rem]  flex flex-row justify-center items-center",children:[(0,y.jsx)("div",{className:"clickable w-[10rem] h-[5rem] mr-4 bg-[url(/public/assets/gaming/coin.png)] bg-contain bg-center bg-no-repeat"}),(0,y.jsx)("div",{className:"clickable w-[3rem] h-[4rem] mt bg-[url(/public/assets/gaming/setting.png)] bg-contain bg-center bg-no-repeat",onClick:function(){return d((function(e){return!e}))}})]})]}),(0,y.jsxs)("div",{className:"main content content--contains-header",children:[n&&(0,y.jsx)(v.IT,{targetDatetime:(new Date).getTime()+144e5}),(0,y.jsxs)(o.Z,{gutter:60,className:"lg:mt-60 mt-40",children:[(0,y.jsx)(l.Z,{xs:24,sm:14,md:14,lg:14,className:"flex flex-row justify-center items-center",children:null===n||void 0===n?void 0:n.config.NFTIds.slice(0,3).map((function(e){return(0,y.jsx)("img",{className:"w-[28rem]",src:(0,g.vg)("gaming/attack_apng_desktop/attack_".concat(q(e)+A(e),"_desktop.png")),alt:"gaming/attack_apng_desktop/attack_".concat(q(e)+A(e),"_desktop.png")})}))}),(0,y.jsx)(l.Z,{xs:24,sm:8,md:8,lg:8,className:"mt-[-1rem] md:mt-[-0.1rem]",children:(0,y.jsx)("img",{className:"w-[68rem]",src:(0,g.vg)("gaming/boss_apng_desktop/boss1_idle_desktop.png"),alt:"gaming/boss_apng_desktop/boss1_idle_desktop.png"})})]})]}),(0,y.jsxs)(x.V,{open:p,onClose:function(){return d(!1)},className:"gaming relative z-50",children:[(0,y.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,y.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,y.jsxs)(x.V.Panel,{className:"flex flex-column justify-center items-center mx-auto max-w-lg rounded w-[20rem] h-[29rem] bg-[url(/public/assets/gaming/bg-dialog.png)] bg-contain bg-center bg-no-repeat",children:[(0,y.jsx)(x.V.Title,{className:"text-3xl text-[#28170B] font-extrabold\tstroke-current",children:"Sound Setting"}),(0,y.jsxs)("div",{className:"w-7/12 mt-6",children:[(0,y.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,y.jsx)("div",{className:"text-2xl text-black",children:"BGM"}),(0,y.jsx)("div",{className:"clickable w-[1.6rem] h-[1.6rem] bg-contain bg-center bg-no-repeat ".concat(F?"bg-[url(/public/assets/gaming/vol-muted.png)]":"bg-[url(/public/assets/gaming/vol.png)]"),onClick:function(){S((function(e){return!e}))}})]}),(0,y.jsxs)("div",{className:"mt-2 flex flex-row justify-between items-center",children:[(0,y.jsx)("div",{className:"text-2xl text-black",children:"SoundEffect"}),(0,y.jsx)("div",{className:"clickable w-[1.6rem] h-[1.6rem] bg-contain bg-center bg-no-repeat ".concat(h?"bg-[url(/public/assets/gaming/vol-muted.png)]":"bg-[url(/public/assets/gaming/vol.png)]"),onClick:function(){w((function(e){return!e}))}})]})]})]})})]}),(0,y.jsx)(j,{isOpen:Q,setIsOpen:_})]})};var N=f.ZP.div(t||(t=(0,a.Z)(["\n  position: absolute;\n  top: 0;\n  right: 0;\n  left: 0;\n  bottom: 0;\n\n  .bg-full {\n    width: 100%;\n    height: 100%;\n    position: fixed;\n    object-fit: cover;\n    z-index: 0;\n  }\n\n  .mask {\n    position: fixed;\n    top: 0;\n    right: 0;\n    left: 0;\n\n    z-index: 11;\n    background: rgba(0, 0, 0, 0.25);\n  }\n\n  .content {\n    position: relative;\n    height: 100vh;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n\n    &--contains-header {\n      margin-top: 80px;\n      height: calc(100vh - 80px);\n    }\n  }\n\n  @media (max-width: 768px) {\n    .content {\n      &--contains-header {\n        margin-top: 60px;\n        height: calc(100vh - 60px);\n      }\n    }\n  }\n\n  & + * {\n    position: relative;\n    top: 100vh;\n  }\n"]))),j=function(e){var n=e.isOpen,r=(e.setIsOpen,(0,h.p)()),t=r.data,a=(r.isLoading,(0,b.u)()),c=a.data,f=(a.isLoading,(0,i.useState)([])),v=(0,s.Z)(f,2),x=v[0],k=v[1],N=(0,w.useMutation)((function(){return(0,g.Kc)(t),x||p.Z.info({message:"No Selected Hero"}),t.stakeNFT(x)}),{onSuccess:function(){p.Z.success({message:"Stake Succeed"}),k([])},onError:function(e){var n;return p.Z.error({message:"Stake Failed",description:null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message})}}),j=(N.mutateAsync,N.isLoading,(0,w.useMutation)((function(){return(0,g.Kc)(c),c.generateAttack()}),{onSuccess:function(){p.Z.success({message:"generate Attacks Succeed"})},onError:function(e){var n;return p.Z.error({message:"generate Attacks Failed",description:null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message})}})),Z=(j.mutateAsync,j.isLoading,(0,w.useMutation)((function(){return(0,g.Kc)(t),x||p.Z.error({message:"No Selected Hero"}),t.withdrawNFT(x)}),{onSuccess:function(){p.Z.success({message:"Withdraw Succeed"}),k([])},onError:function(e){var n;return p.Z.error({message:"Withdraw Failed",description:null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message})}}));Z.mutateAsync,Z.isLoading;return(0,y.jsx)(d.Z,{visible:n,maskStyle:{background:"rgba(0,0,0,.95)"},className:"gaming relative z-50",width:1200,footer:null,closable:!1,children:(0,y.jsxs)(o.Z,{gutter:0,justify:"center",children:[(0,y.jsx)(u.rU,{to:"/gaming/goblin/1",children:(0,y.jsx)(m.Z,{children:"Start"})}),(0,y.jsx)(l.Z,{sm:24,md:24,lg:24,children:(0,y.jsx)("img",{className:"db center mw-100 mb4 shadow-3",src:(0,g.vg)("gaming/adventure-modal.png"),alt:""})})]})})}}}]);